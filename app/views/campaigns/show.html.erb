

<section class="campaign-section2"

<% unless @campaign.image.nil? %>
<div class="campaign-header">

    <%= image_tag @campaign.image.url(:large) %>
</div>  
<% end %>

  <div id="campaigns2">
    <div class="campaign-show">
   
    	 <div class="campaignshow-info">

        <div class="campaign-add">

       

          <div class="campaign-halfbox">

                <% unless @campaign.title.nil? || @campaign.title.empty? %>
                    <h1><strong><%= @campaign.title %></strong></h1>
                <% end %>

          <div class="campaign-status">
              Experiment: <span style="text-transform: uppercase;"><%= @campaign.status %></span>
          </div>

        <% if @campaign.status == "closed" %>
            





        <% else %>
              <div class="how-box2">
              <% if @chosen_lyrics.any? %>
              <div class="timer-info">
              <%= link_to "Chosen Lyric(s)", '#lyric-chosen' %>
            </div>
              <% else %>
              
              <div class="timer-box2">
                <% if @campaign.timer.nil? || @campaign.timer.empty? %>
                    <div class="timer-info">Lyric submissions not open yet</div>
                <% else %>
                  <% unless @campaign.timer.nil? || @campaign.timer.empty? %>
                  <%= link_to 'Submit Lyrics', new_campaign_lyric_path(@campaign, @lyric), class: "submitbutton" %><span class="add-timer">Lyrics:</span>
                    <div class="timer-info"><span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                    <span class="timer-line" data-countdown= <%= @campaign.timer %> ></span>
                  </div>
                  <% end %>
                <% end %>
              </div>

            <% end %>
            </div>

            <div class="how-box2-mobile">
             <% if @chosen_lyrics.any? %>
              <div class="timer-info">
              <%= link_to "Chosen Lyric(s)", '#lyric-chosen' %>
            </div>
              <% else %>
              
              <div class="timer-box2">
                <% if @campaign.timer.nil? || @campaign.timer.empty? %>
                    <div class="timer-info">Lyric submissions not open yet</div>
                <% else %>
                  <% unless @campaign.timer.nil? || @campaign.timer.empty? %>
                      <%= link_to new_campaign_lyric_path(@campaign, @lyric) do %>
                        <i class="fa fa-headphones"></i>
                      <% end %>
                  <span class="add-timer">Lyrics:</span>
                    <div class="timer-info"><span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                    <span class="timer-line" data-countdown= <%= @campaign.timer %> ></span>
                  </div>
                  <% end %>
                <% end %>
              </div>

            <% end %>


            </div>

            <div class="how-box2">
              <% if @chosen_arts.any? %>
                  <div class="timer-info">
                  <%= link_to "Chosen Design(s)", '#art-chosen' %>
                </div>
               <% else %>
              
                <div class="timer-box2">
                   <% if @campaign.timer2.nil? || @campaign.timer2.empty? %>
                  <div class="timer-info">Design submissions not open yet</div>
                  <% else %>
                  <% unless @campaign.timer2.nil? || @campaign.timer2.empty? %>
                  <%= link_to 'Submit Designs', new_campaign_art_path(@campaign, @art), class: "submitbutton" %>
                  <div class="timer-info"><span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                    <span class="timer-line" data-countdown= <%= @campaign.timer2 %> ></span>
                  </div>
                    <% end %>
                    <% end %>
                  </div>
                  <% end %>
            </div>

              <div class="how-box2-mobile">
              <% if @chosen_arts.any? %>
                  <div class="timer-info">
                  <%= link_to "Chosen Design(s)", '#art-chosen' %>
                </div>
               <% else %>
              
                <div class="timer-box2">
                   <% if @campaign.timer2.nil? || @campaign.timer2.empty? %>
                  <div class="timer-info">Design submissions not open yet</div>
                  <% else %>
                  <% unless @campaign.timer2.nil? || @campaign.timer2.empty? %>
                      <%= link_to new_campaign_art_path(@campaign, @art) do %>
                        <i class="fa fa-paint-brush"></i>
                      <% end %>
                  <div class="timer-info"><span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                    <span class="timer-line" data-countdown= <%= @campaign.timer2 %> ></span>
                  </div>
                    <% end %>
                    <% end %>
                  </div>
                  <% end %>
            </div>
        <% end %>

      </div>
          <div class="campaign-halfbox2">
              <div class="campaign-boxinfo">

                <h3>Rewards:</h3>

                <%= simple_format(@campaign.reward) %>


                *For Design Submissions


              </div>

                      <div class="campaign-boxinfo">

                <h3>Rules:</h3>

                <%= simple_format(@campaign.rules) %>


              </div>
            </div>

               <div class="admin-footer">
                  <% if can? :update, @campaign %>
                <%= link_to 'Edit', edit_campaign_path(@campaign) %> | 
                <% end %>
                <% if can? :destroy, @campaign %>
                <%= link_to 'Destroy', campaign_path(@campaign), method: :delete, data: {confirm: "Are you sure?" } %>   
                <% end %>
              </div>

      <div class="next-prev">

        Experiments: <% if @campaign == Campaign.first %> <span style="color: #000;">Prev</span> <% else %><%= link_to 'Prev', campaign_path(@previous_campaign) %> <% end %><strong>/</strong> <% if @campaign == Campaign.last %> <span style="color: #000;">Next</span> <% else %> <%= link_to 'Next', campaign_path(@next_campaign) %><% end %>


      </div>

      </div>


         <% unless @campaign.title.nil? || @campaign.title.empty? %>
        <h1><strong><%= @campaign.title %></strong></h1>
        <% end %>
        <% unless @campaign.description.nil? || @campaign.description.empty? %>
        <div class="campaignshow-desc">
          <%= simple_format(@campaign.description) %>
        </div>
        <% end %>
      </br>

      <% if @chosen_lyrics.any? %>
      <div id="lyric-chosen" class="chosen-box">
        <h1>Chosen Lyric(s)</h1><div class="clear"></div>
        <% @chosen_lyrics.each do |chosen_lyric| %>

            <div class="campaign-lyric-each">
                    <% unless chosen_lyric.line.nil? || chosen_lyric.line.empty? %>
                    <span class="quote-span">"</span>
           
                    <%= link_to chosen_lyric.line, campaign_lyric_path(@campaign, chosen_lyric), class: 'chosen_lyric' %><span class="quote-span2">"</span>
                    <% end %>
                  <ul>
              <li><% unless chosen_lyric.user.avatar.nil? %><%= image_tag chosen_lyric.user.avatar.url(:mini) %><% end %><% unless chosen_lyric.user.username.nil? || chosen_lyric.user.username.empty? %><%= link_to chosen_lyric.user.username, profile_url(:id => chosen_lyric.user.username) %><% end %></li>
          </ul>
          </div>


        <% end %>


      </div>
      <% end %>

      <% if @chosen_arts.any? %>
      <div id="art-chosen" class="chosen-box">
        <h1>Chosen Design(s)</h1><div class="clear"></div>
        
                <% @chosen_arts.each do |chosen_art| %>
                  <div class="campaign-art-each">
                    <%= link_to campaign_art_path(@campaign, chosen_art) do %>

                    <% unless chosen_art.image.nil? %>
                    <%= image_tag chosen_art.image.url(:medium) %>
                    <% end %>
                  <% end %>
                  </div>
                <% end %>
      </div>
      <% end %>


       </div>
       

  </div>

    <div class="tab-box" role="tabpanel">

        <!-- Nav tabs -->
        <ul class="nav nav-tabs" role="tablist">
          <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Lyrics</a></li>
          <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">Designs</a></li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
          <div role="tabpanel" class="tab-pane active" id="home">
              <div class="campaign-lyric">
                <% @lyrics.each do |lyric| %>
                  <div class="campaign-lyric-each">
                    <% unless lyric.line.nil? || lyric.line.empty? %>
                    <%= link_to lyric.line, campaign_lyric_path(@campaign, lyric) %>
                    <% end %>
                    
                    <ul>
                      <% if user_signed_in? %>
                      <li><span class="updown-button"><span class="up <%= lyric.id %>"><%= lyric.get_upvotes.size %> </span>
                      <%= link_to like_lyric_path(lyric), class: ['voteup', lyric.id], remote: true, data: { type: :json }, method: :get do %>
                      <span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span>
                        <% end %>
                      </span>
                    </li>
                    <li>
                        <span class="updown-button"><span class="down <%= lyric.id %>"><%= lyric.get_downvotes.size %></span>
                      <%= link_to dislike_lyric_path(lyric), class: ['votedown', lyric.id], remote: true, data: { type: :json }, method: :get do %>
                      <span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span>
                        <% end %>
                      </span>

                      </li>

                      <% else %>

                      <li><span class="updown-button"><span class="up <%= lyric.id %>"><%= lyric.get_upvotes.size %> </span>
                      <%= link_to_if user_signed_in?, like_lyric_path(lyric), class: ['voteup', lyric.id], remote: true, data: { type: :json }, method: :get do %>
                      <span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span>
                        <% end %>
                      </span>
                    </li>
                    <li>
                        <span class="updown-button"><span class="down <%= lyric.id %>"><%= lyric.get_downvotes.size %></span>
                      <%= link_to_if user_signed_in?, dislike_lyric_path(lyric), class: ['votedown', lyric.id], remote: true, data: { type: :json }, method: :get do %>
                      <span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span>
                        <% end %>
                      </span>
                    
                      <span type="button" data-toggle="tooltip" data-placement="top" title="Sign In To Vote" class="glyphicon glyphicon-question-sign" aria-hidden="true"></span>
                      </li>


                      <% end %>

                      <li><%= lyric.impressionist_count(:filter=>:session_hash) %> <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span></li>


              <script>

                $('.voteup' + '.<%= lyric.id %>')
              .on('ajax:success', function (e, data, status, xhr) { 
                $('.up' + '.<%= lyric.id %>').html(data.count);
                $('.down' + '.<%= lyric.id %>').html(data.count2);
              });

                </script>

                  <script>

                $('.votedown' + '.<%= lyric.id %>')
              .on('ajax:success', function (e, data, status, xhr) { 
                
                $('.down' + '.<%= lyric.id %>').html(data.count2);
                $('.up' + '.<%= lyric.id %>').html(data.count);
              });

                </script>

                  
                    <li><%= lyric.comments.count %> <span class="glyphicon glyphicon-comment" aria-hidden="true"></span></li>
                    <li><% if lyric.user.avatar.present? %><%= image_tag lyric.user.avatar.url(:mini) %><% end %><% if lyric.user.username.present? %><%= link_to lyric.user.username, profile_url(:id => lyric.user.username) %><% end%></li>
                   
                    <% if lyric.personal == true %>
                    <li><span data-toggle="tooltip" data-placement="top" title="Submitted By Artist"><span class="glyphicon glyphicon-star" aria-hidden="true"></span></span></li>
                   <% end %>

                    </ul>
          </div>
          <% end %>
      
    </div>

          </div>
          <div role="tabpanel" class="tab-pane" id="profile">
          <div class="art-container">
            
              <div id="campaign-art" class="transitions-enabled">
                 
                <% @arts.each do |art| %>
                  <div class="campaign-art-each">
                    <%= link_to campaign_art_path(@campaign, art) do %>

                    <% unless art.image.nil? %>
                    <%= image_tag art.image.url(:small) %>
                    <% end %>
                  <% end %>
                  </div>
                <% end %>
              </div>
            </div>

          </div>

        </div>
      </div>

  </div>

  <%= render 'layouts/footer' %>
</section>

<section class="home-info">


  <div class="results"></div>
    

</section>



  <script type="text/javascript">
    $('[data-countdown]').each(function() {
      var $this = $(this), finalDate = $(this).data('countdown');
    
    $this.countdown(finalDate)

    .on('update.countdown', function(event) {
      var format = '%-H hr %-M min %-S sec';
      var format2 = '%-H hr %-M min';  
      if (event.offset.days < 1) {
          $this.closest('.price-info').addClass('red-status');
      }   
      if(event.offset.days > 0) {
        format = '%-d day%!d, ' + format2;
      }
      if(event.offset.weeks > 0) {
        format = '%-w week%!w ' + format2;
      }
    
     $(this).html(event.strftime(format));
   })
   .on('finish.countdown', function(event) {
     $(this).html('Closed for Submissions');
    $this.closest('.timer-box2').addClass('disabled').attr('disabled', 'disabled');
      });
    
    });
</script>

<script>

  $('.results').html("<%= j render(:partial => 'homeinfo/index') %>")

</script>

<script>
$(window).scroll(function () {
    var winTop = $(this).scrollTop(),
        winBottom = winTop + $(this).height(),
        left = $('.home-info'),
        leftBottom = left.height(),
        right = $('.campaign-section2'),
        rightBottom = right.height();
    //when the user reached the bottom of '#leftShort' set its position to fixed 
    //to prevent it from moving on scroll 
    if (rightBottom <= leftBottom){


    } else{

          if (winBottom >= leftBottom) {
        left.css({
            'position': 'fixed',
            'bottom': '0px',
            
        });
    } else {
        //when the user scrolls back up revert its position to relative
        // to make it move up together with '#rightLong'
        left.css({
            'position': 'relative',
            'bottom': 'auto'

        });
    }

    }


});

</script>

<script>
$(function () {
  $('[data-toggle="tooltip"]').tooltip()
})
</script>